import { Meta, Description } from '@storybook/addon-docs';

<Meta title="Docs/Coding Guidelines/Components" />

# Components

To ensure that code is as reusable as possible, this project uses React
components. Components should be named in a descriptive manner
( e.g. `notification-panel`) and should be written in PascalCase.

Wherever possible, [Material-UI] components should be used, however if the need
arises, you can add a custom component. It is recommended that you use the
[BuildCom] command to create your component.

e.g.

```bash
yarn bc
```

This will ask you to enter the name of your component and then create a new
component in the `./components` folder with all of the default files required.

If you are not using [BuildCom] then you should structure your component as
follows (`?` denotes optional files/folders):

```asciidoc
root
└──components
    └──component-name
        ├──helpers (?)
        ├──images (?)
        ├──tests (?)
        ├──mocks (?)
        ├──index.stories.tsx
        ├──index.test.tsx
        ├──index.tsx
        ├──README.md
        └──styles.module.scss (?)
```

## Naming

The component file should be named `index.tsx` as this allows the component to
be referenced via the folder name only in imports (e.g.
`@components/progress-indicator` instead of `@components/progress-indicator/`progress-indicator).

## TypeScript

There should be no JavaScript inside a component, it should be [TypeScript]
only. TypeScript is set to `strict` mode and does not allow the use of `any`,
components that are not covered by type definitions will not be merged into the
project. You may find that the type definition that you need has already been
created, take a look in the `./lib/types` folder before you make new definitions.

## One component per folder

You should not nest components, if you want to make a smaller component inside
a larger component, then that should be a component in its own right.

## Adding helper functions

Helper functions are used to help a component do something which isn't directly
related to the output of the component itself (void functions such as click
handlers, state setters, etc... are allowed to live in the tsx file).

All helper functions should reside in ./helpers and have one function per file
(if necessary, one class with multiple methods is also acceptable but if you use
that, you will be asked to justify its use in your Merge Request.)

## Adding Unit Tests

Every component should have a unit test, even if it's just a basic snapshot test.
Every helper function should also have its own spec file giving as close to
100% coverage as it's possible to get.

Tests are written using [React Testing Library].

## Generating snapshots

Once you have added the code to test for snapshots, you will need to generate
them before your tests will pass. To do this simply run `yarn test:unit -u` in
the project root. These snapshots will also be generated when running
`yarn preflight`.

## Adding stories

All components, no matter how small or large should have a [Storybook] entry.
Ideally, a component should be built in isolation and tested within Storybook
before being imported into the primary project, this ensures that the component
is robust and works by itself. It also provides a handy component library for
developers to be able to reuse components and prevent the reinvention of the
wheel.

Rather than document how to use [Storybook], please refer to the excellent
[Storybook Documentation]

When adding a story, please ensure you add a prefix to the title to ensure that
it appears in the correct Storybook group based on its type, this should be one
of `atom`, `molecule` or `organism`. Refer to The Atomic Design Principle for
guidance.

e.g.

```js
export default {
  title: 'atom/InputLabel'
};
```

Each story should be named in a descriptive manner, although the first story may
be named `Default`. If it is the only story for that component then Default is
also an acceptable name.

> **Tip:** Stories are named after their PascalCased variables and will output
> as a regular sentence. e.g. `OverviewComplete` will be shown as
> `Overview Complete` in Storybook.

Stories are required for all components, a Merge Request will not be approved
unless you show a working screenshot from that component's story.

## Updating the README

For the most part, the README, is auto-generated by [BuildCom], the only part
which needs to be edited is the description (the first paragraph). Everything
else should be left as it is as it will be used by [Storybook] to populate the
documentation there.

## Using Mocks

Mock data should be used to populate the Story and Test data.

In a similar way to the custom types, it's worth checking to see if the mock
data you require is available in the `./lib/mocks` folder and if you are making
mock data that is likely to be reusable in other parts of the application,
please also consider adding it to that folder.

Do not add more data than is required as a) This will add bloat to the
[storybook] code preview and b) it will require you making an excessively
large custom type.

### Other things to consider when making a new component

- Each component should have a single task (See Brad Frost's
  [Atomic Design Principle] for more information) and be written as a 'pure'
  component. This means that it should only use React's hooks along with props to
  receive and pass information and should have no awareness of the project's
  contexts, stores or anything else.
- Components should be pure functions and not use a class.

[Next: StyleSheets](?path=/story/docs-coding-guidelines-stylesheets--page)

[material-ui]: https://mui.com/ 'Material-UI'
[buildcom]: https://www.npmjs.com/package/buildcom 'BuildCom'
[typescript]: https://www.typescriptlang.org 'TypeScript'
[react testing library]: https://testing-library.com/docs/react-testing-library/intro 'React Testing Library'
[storybook]: https://storybook.js.org/ 'Storybook'
[storybook documentation]: https://storybook.js.org/docs/react/get-started/introduction 'Storybook Documentation'
[ atomic design principle]: https://bradfrost.com/blog/post/atomic-web-design/ 'Atomic Design Principle'
